Global.initUtils=(()=>{Global.utils={html_root_dom:document.querySelector("html"),pageContainer_dom:document.querySelector(".page-container"),pageTop_dom:document.querySelector(".main-content-header"),homeBanner_dom:document.querySelector(".home-banner-container"),scrollProgressBar_dom:document.querySelector(".scroll-progress-bar"),pjaxProgressBar_dom:document.querySelector(".pjax-progress-bar"),pjaxProgressIcon_dom:document.querySelector(".pjax-progress-icon"),backToTopButton_dom:document.querySelector(".tool-scroll-to-top"),toolsList:document.querySelector(".hidden-tools-list"),toggleButton:document.querySelector(".toggle-tools-list"),innerHeight:window.innerHeight,pjaxProgressBarTimer:null,prevScrollValue:0,fontSizeLevel:0,isHasScrollProgressBar:!0===Global.theme_config.global.scroll_progress.bar,isHasScrollPercent:!0===Global.theme_config.global.scroll_progress.percentage,updateScrollStyle(){const e=window.pageYOffset||document.documentElement.scrollTop,t=document.documentElement.scrollHeight,o=window.innerHeight||document.documentElement.clientHeight,s=Math.round(e/(t-o)*100);if(this.isHasScrollProgressBar){const a=(e/(t-o)*100).toFixed(3);this.scrollProgressBar_dom.style.visibility=0===s?"hidden":"visible",this.scrollProgressBar_dom.style.width=`${a}%`}if(this.isHasScrollPercent){const e=this.backToTopButton_dom.querySelector(".percent");this.backToTopButton_dom.classList.toggle("show",0!==s&&void 0!==s),e.innerHTML=s.toFixed(0)}Global.theme_config.navbar.auto_hide?this.pageTop_dom.classList.toggle("hide",this.prevScrollValue>o&&e>this.prevScrollValue):this.pageTop_dom.classList.remove("hide"),this.prevScrollValue=e},registerWindowScroll(){window.addEventListener("scroll",()=>{if(this.updateScrollStyle(),Global.theme_config.articles.toc.enable&&Global.utils.hasOwnProperty("updateActiveTOCLink")&&Global.utils.updateActiveTOCLink(),navbarShrink.init(),"fixed"===Global.theme_config.home_banner.style){const e=document.querySelector(".home-banner-background"),t=window.innerHeight,o=window.scrollY||window.pageYOffset,s=t/4,a=o>=s?Math.min((o-s)/50,15):0;try{e.style.webkitFilter=`blur(${a}px)`}catch(e){}}for(var e=window.pageYOffset,t=document.body.scrollHeight,o=window.innerHeight,s=document.getElementsByClassName("right-side-tools-container"),a=0;a<s.length;a++){var r=s[a];e<=0?"/"!==location.pathname||r.classList.add("hide"):e+o>=t-20?r.classList.add("hide"):r.classList.remove("hide")}var l=document.getElementById("aplayer");null==l||(e<=0?"/"!==location.pathname||l.classList.add("hide"):e+o>=t-20?l.classList.add("hide"):l.classList.remove("hide"))})},toggleToolsList(){this.toggleButton.addEventListener("click",()=>{this.toolsList.classList.toggle("show")})},globalFontSizeAdjust(){const e=this.html_root_dom,t=document.querySelector(".tool-font-adjust-plus"),o=document.querySelector(".tool-font-adjust-minus"),s=document.defaultView.getComputedStyle(document.body).fontSize,a=parseFloat(s);let r=0;const l=Global.getStyleStatus();function i(t){e.style.fontSize=`${a*(1+.05*t)}px`,Global.styleStatus.fontSizeLevel=t,Global.setStyleStatus()}l&&i(r=l.fontSizeLevel),t.addEventListener("click",()=>{switch(r){case 0:r=1;break;case 1:r=2;break;case 2:r=3;break;case 3:r=4;break;case 4:r=5}i(r)}),o.addEventListener("click",()=>{switch(r){case 1:r=0;break;case 2:r=1;break;case 3:r=2;break;case 4:r=3;break;case 5:r=4}i(r)})},contentAreaWidthAdjust(){const e=document.querySelector(".tool-expand-width"),t=document.querySelector(".navbar-content"),o=document.querySelector(".main-content"),s=e.querySelector("i"),a=Global.theme_config.global.content_max_width||"1000px";let r=a,l=!1;!0===Global.theme_config.home_banner.enable&&"/"===window.location.pathname&&(r=1.2*parseInt(a)+"px");const i=e=>{Global.styleStatus.isExpandPageWidth=e,Global.setStyleStatus(),e?(s.classList.remove("fa-expand"),s.classList.add("fa-compress"),t.style.maxWidth="90%",o.style.maxWidth="90%"):(s.classList.remove("fa-compress"),s.classList.add("fa-expand"),t.style.maxWidth=r,o.style.maxWidth=a)};(()=>{const e=Global.getStyleStatus();e&&(l=e.isExpandPageWidth,i(l))})(),e.addEventListener("click",()=>{i(l=!l)})},goComment(){this.goComment_dom=document.querySelector(".go-comment"),this.goComment_dom&&this.goComment_dom.addEventListener("click",()=>{const e=document.querySelector("#comment-anchor").getBoundingClientRect().top+window.scrollY;window.anime({targets:document.scrollingElement,duration:500,easing:"linear",scrollTop:e-10})})},getElementHeight(e){const t=document.querySelector(e);return t?t.getBoundingClientRect().height:0},inithomeBannerHeight(){this.homeBanner_dom&&(this.homeBanner_dom.style.height=this.innerHeight+"px")},initPageHeightHandle(){if(this.homeBanner_dom)return;const e=this.getElementHeight(".main-content-header")+this.getElementHeight(".main-content-body")+this.getElementHeight(".main-content-footer"),t=window.innerHeight,o=document.querySelector(".main-content-footer");if(e<t){const s=Math.floor(t-e);s>0&&(o.style.marginTop=`${s-2}px`)}},imageViewer(){let e=!1;const t=(e,t)=>{document.body.style.overflow=t?"hidden":"auto",t?e.classList.add("active"):e.classList.remove("active")},o=document.querySelector(".image-viewer-container"),s=document.querySelector(".image-viewer-container img");o&&o.addEventListener("click",()=>{t(o,e=!1)});const a=document.querySelectorAll(".markdown-body img");a.length?a.forEach(a=>{a.addEventListener("click",()=>{t(o,e=!0),s.setAttribute("src",a.getAttribute("src"))})}):this.pageContainer_dom.removeChild(o)},setHowLongAgoLanguage:(e,t)=>t.replace(/%s/g,e),getHowLongAgo(e){const t=Global.language_ago,o=Math.floor(e/2592e3/12),s=Math.floor(e/2592e3),a=Math.floor(e/86400/7),r=Math.floor(e/86400),l=Math.floor(e/3600%24),i=Math.floor(e/60%60),n=Math.floor(e%60);return o>0?this.setHowLongAgoLanguage(o,t.year):s>0?this.setHowLongAgoLanguage(s,t.month):a>0?this.setHowLongAgoLanguage(a,t.week):r>0?this.setHowLongAgoLanguage(r,t.day):l>0?this.setHowLongAgoLanguage(l,t.hour):i>0?this.setHowLongAgoLanguage(i,t.minute):n>0?this.setHowLongAgoLanguage(n,t.second):void 0},relativeTimeInHome(){const e=document.querySelectorAll(".home-article-meta-info .home-article-date"),t=Global.theme_config.home.article_date_format;"relative"===t?e&&e.forEach(e=>{const t=Date.now(),o=new Date(e.dataset.date.split(" GMT")[0]).getTime();e.innerHTML=this.getHowLongAgo(Math.floor((t-o)/1e3))}):"auto"===t&&e&&e.forEach(e=>{const t=Date.now(),o=new Date(e.dataset.date.split(" GMT")[0]).getTime();Math.floor((t-o)/864e5)<7&&(e.innerHTML=this.getHowLongAgo(Math.floor((t-o)/1e3)))})},pjaxProgressBarStart(){this.pjaxProgressBarTimer&&clearInterval(this.pjaxProgressBarTimer),this.isHasScrollProgressBar&&this.scrollProgressBar_dom.classList.add("hide"),this.pjaxProgressBar_dom.style.width="0",this.pjaxProgressIcon_dom.classList.add("show");let e=1;this.pjaxProgressBar_dom.classList.add("show"),this.pjaxProgressBar_dom.style.width=e+"%",this.pjaxProgressBarTimer=setInterval(()=>{(e+=5)>99&&(e=99),this.pjaxProgressBar_dom.style.width=e+"%"},100)},pjaxProgressBarEnd(){this.pjaxProgressBarTimer&&clearInterval(this.pjaxProgressBarTimer),this.pjaxProgressBar_dom.style.width="100%";const e=setTimeout(()=>{this.pjaxProgressBar_dom.classList.remove("show"),this.pjaxProgressIcon_dom.classList.remove("show"),this.isHasScrollProgressBar&&this.scrollProgressBar_dom.classList.remove("hide");const t=setTimeout(()=>{this.pjaxProgressBar_dom.style.width="0",clearTimeout(e),clearTimeout(t)},200)},200)}},Global.utils.registerWindowScroll(),Global.utils.toggleToolsList(),Global.utils.globalFontSizeAdjust(),Global.utils.contentAreaWidthAdjust(),Global.utils.goComment(),Global.utils.initPageHeightHandle(),Global.utils.inithomeBannerHeight(),Global.utils.imageViewer(),Global.utils.relativeTimeInHome()});